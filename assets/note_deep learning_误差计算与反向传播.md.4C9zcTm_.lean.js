import{_ as l,c as T,l as Q,a5 as a,aa as s,a as e,ab as m,o as t,ac as d}from"./chunks/framework.D5vfm64Q.js";const u1=JSON.parse('{"title":"误差计算与反向传播","description":"","frontmatter":{},"headers":[],"relativePath":"note/deep learning/误差计算与反向传播.md","filePath":"note/deep learning/误差计算与反向传播.md","lastUpdated":1713021612000}'),o={name:"note/deep learning/误差计算与反向传播.md"},n=a("",5),r={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.738ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.076ex",height:"4.774ex",role:"img",focusable:"false",viewBox:"0 -1342 16387.6 2110","aria-hidden":"true"},h=a("",1),g=[h],p=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"s"),Q("mi",null,"i"),Q("mi",null,"g"),Q("mi",null,"m"),Q("mi",null,"o"),Q("mi",null,"i"),Q("mi",null,"d"),Q("mi",{mathvariant:"normal"},"函"),Q("mi",{mathvariant:"normal"},"数"),Q("mi",null,"："),Q("mi",null,"s"),Q("mi",null,"i"),Q("mi",null,"g"),Q("mi",null,"m"),Q("mi",null,"o"),Q("mi",null,"i"),Q("mi",null,"d"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"x"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mn",null,"1"),Q("mrow",null,[Q("mn",null,"1"),Q("mo",null,"+"),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"−"),Q("mi",null,"x")])])])])])],-1),c=Q("p",null,"w_i_j表示i是前一层第i个节点于本层第j个节点的权重参数",-1),H={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.858ex"},xmlns:"http://www.w3.org/2000/svg",width:"39.573ex",height:"6.733ex",role:"img",focusable:"false",viewBox:"0 -1712.4 17491.4 2975.8","aria-hidden":"true"},w=a("",1),f=[w],L=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"s"),Q("mi",null,"o"),Q("mi",null,"f"),Q("mi",null,"t"),Q("mi",null,"m"),Q("mi",null,"a"),Q("mi",null,"x"),Q("mi",{mathvariant:"normal"},"函"),Q("mi",{mathvariant:"normal"},"数"),Q("mi",null,"："),Q("mi",null,"P"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"y"),Q("mo",null,"="),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mfrac",null,[Q("mrow",null,[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"T")])])])]),Q("msub",null,[Q("mi",null,"w"),Q("mi",null,"j")])]),Q("mrow",null,[Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"k"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"K")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msup",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"T")])])])]),Q("msub",null,[Q("mi",null,"w"),Q("mi",null,"k")])])])])])],-1),M=Q("p",null,"前向传播的计算y_1的输出，在经过softmax激活得到一个有概率分布约束的输出数值。",-1),x=Q("p",null,[Q("img",{src:s,alt:"前向传播过程",loading:"lazy"})],-1),y={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.738ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.941ex",height:"4.795ex",role:"img",focusable:"false",viewBox:"0 -1351.5 6603.9 2119.5","aria-hidden":"true"},k=a("",1),_=[k],D=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"O"),Q("mn",null,"1")]),Q("mo",null,"="),Q("mfrac",null,[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"y"),Q("mn",null,"1")])])]),Q("mrow",null,[Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"y"),Q("mn",null,"1")])])]),Q("mo",null,"+"),Q("msup",null,[Q("mi",null,"e"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"y"),Q("mn",null,"2")])])])])])])],-1),V=Q("p",null,"同理O_2也是这样得到的。",-1),b=Q("h2",{id:"损失计算",tabindex:"-1"},[e("损失计算 "),Q("a",{class:"header-anchor",href:"#损失计算","aria-label":'Permalink to "损失计算"'},"​")],-1),v=Q("p",null,"分类的损失一般使用交叉熵损失函数。函数中O_i是预测标签的值，O^*_i是真实标签的值。",-1),j=Q("h4",{id:"多分类的交叉熵损失函数",tabindex:"-1"},[e("多分类的交叉熵损失函数： "),Q("a",{class:"header-anchor",href:"#多分类的交叉熵损失函数","aria-label":'Permalink to "多分类的交叉熵损失函数："'},"​")],-1),C=Q("p",null,"输入的是softmax函数输出的结果，所有事件的概率和为1，即输出的各个节点的概率是在同一个分布中的。在torch的交叉熵损失代码中已经加入了softmax",-1),A={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.697ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.937ex",height:"4.847ex",role:"img",focusable:"false",viewBox:"0 -950 10138.3 2142.2","aria-hidden":"true"},O=a("",1),S=[O],P=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"H"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",null,"−"),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msubsup",null,[Q("mi",null,"o"),Q("mi",null,"i"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mo",null,"∗")])])]),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")")])],-1),B=Q("h4",{id:"二分类的交叉熵损失函数",tabindex:"-1"},[e("二分类的交叉熵损失函数 "),Q("a",{class:"header-anchor",href:"#二分类的交叉熵损失函数","aria-label":'Permalink to "二分类的交叉熵损失函数"'},"​")],-1),X=Q("p",null,"输入是sigmoid函数输出的结果，输出的各个节点的之间的概率数值是不相关的。",-1),z={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},I={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.179ex",height:"6.74ex",role:"img",focusable:"false",viewBox:"0 -1733 20853.3 2978.9","aria-hidden":"true"},E=a("",1),N=[E],G=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"H"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",null,"−"),Q("mfrac",null,[Q("mn",null,"1"),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"K")])]),Q("mo",{stretchy:"false"},"["),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"1"),Q("mo",null,"−"),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mn",null,"1"),Q("mo",null,"−"),Q("msub",null,[Q("mi",null,"o"),Q("mi",null,"i")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},"]")])],-1),J=Q("p",null,"对于上面的网络我们的损失计算如下：",-1),q={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"34.482ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 15241.2 1000","aria-hidden":"true"},$=a("",1),K=[$],U=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"L"),Q("mi",null,"o"),Q("mi",null,"s"),Q("mi",null,"s"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"o"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("mo",null,"−"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"1")]),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"1")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"+"),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"2")]),Q("mi",null,"l"),Q("mi",null,"o"),Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"o"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")"),Q("mo",{stretchy:"false"},")")])],-1),W=Q("h2",{id:"反向传播与参数更新",tabindex:"-1"},[e("反向传播与参数更新 "),Q("a",{class:"header-anchor",href:"#反向传播与参数更新","aria-label":'Permalink to "反向传播与参数更新"'},"​")],-1),Y=Q("p",null,"反向传播需要先求梯度，所以我们选择的函数尽量是可导且容易收敛。以更新第二层的w_11为例。",-1),Q1=Q("p",null,[e("先求梯度： "),Q("img",{src:m,alt:"梯度求解",loading:"lazy"})],-1),T1=Q("p",null,"参数的更新是：",-1),t1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.076ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -903.7 16387.4 1108.7","aria-hidden":"true"},e1=a("",1),l1=[e1],s1=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msup",null,[Q("mi",null,"w"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n"),Q("mi",null,"e"),Q("mi",null,"w")])]),Q("mo",null,"="),Q("msup",null,[Q("mi",null,"w"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"o"),Q("mi",null,"l"),Q("mi",null,"d")])]),Q("mo",null,"−"),Q("mi",null,"L"),Q("mi",null,"e"),Q("mi",null,"a"),Q("mi",null,"r"),Q("mi",null,"n"),Q("mi",null,"n"),Q("mi",null,"i"),Q("mi",null,"n"),Q("mi",null,"g"),Q("mi",null,"R"),Q("mi",null,"a"),Q("mi",null,"t"),Q("mi",null,"e"),Q("mi",null,"c"),Q("mi",null,"×"),Q("mi",null,"g"),Q("mi",null,"r"),Q("mi",null,"a"),Q("mi",null,"d")])],-1),m1=Q("h2",{id:"优化器",tabindex:"-1"},[e("优化器 "),Q("a",{class:"header-anchor",href:"#优化器","aria-label":'Permalink to "优化器"'},"​")],-1),d1=Q("p",null,"因为内存大小限制，我们不能一次性把train_set的数据用于训练需分batch，这样的话我们求梯度的方向就不一定是全局最优的方向，可以使用优化器解决这个问题。",-1),o1=Q("p",null,"SGD、Adagrad、RMSProp、Adam",-1);function n1(r1,i1,h1,g1,p1,c1){return t(),T("div",null,[n,Q("mjx-container",r,[(t(),T("svg",i,g)),p]),c,Q("mjx-container",H,[(t(),T("svg",u,f)),L]),M,x,Q("mjx-container",y,[(t(),T("svg",Z,_)),D]),V,b,v,j,C,Q("mjx-container",A,[(t(),T("svg",R,S)),P]),B,X,Q("mjx-container",z,[(t(),T("svg",I,N)),G]),J,Q("mjx-container",q,[(t(),T("svg",F,K)),U]),W,Y,Q1,T1,Q("mjx-container",t1,[(t(),T("svg",a1,l1)),s1]),m1,d1,o1])}const w1=l(o,[["render",n1]]);export{u1 as __pageData,w1 as default};
